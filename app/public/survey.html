<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
</head>
<body>
    <div id="myModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <p id="bestMatch"></p>
        </div>
    </div>
    <div class="container">
        <h2>Survey Questions</h2>
        <hr>
        <h3>About You</h>
        <h4>Name (required)</h4>
        <input id ="name" name="name" type="text" style="width: 600px;">
        <br>
        <br>
        <h4>Link to Photo (required)</h4>
        <input id = "photo" name="photo" type="text" style="width: 600px;">
        <br>
        <br>
        <h3>Question 1</h>
        <h4>Your mind is always buzzing with unexplored ideas and plans.</h4>
        <select id = "Q1" name="Q1" type="text" style="width: 300px;">
            <option value="1">1 (strongly disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (strongly agree)</option>
        </select>    
        <h3>Question 2</h>
        <h4>Generally speaking, you rely more on your experience than your imagination.</h4>
        <select id="Q2"name="Q2" type="text" style="width: 300px;">
            <option value="1">1 (strongly disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (strongly agree)</option>
        </select>   
        <h3>Question 3</h>
        <h4>You find it easy to stay relaxed and focused even when there is some pressure.</h4>
        <select id="Q3" name="Q3" type="text" style="width: 300px;">
            <option value="1">1 (strongly disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (strongly agree)</option>
        </select>
        <h3>Question 4</h>
        <h4>You rarely do something just out of sheer curiosity.</h4>
        <select id="Q4" name="Q4" type="text" style="width: 300px;">
            <option value="1">1 (strongly disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (strongly agree)</option>
        </select>
        <h3>Question 5</h>
        <h4>People can rarely upset you.</h4>
        <select id="Q5" name="Q5" type="text" style="width: 300px;">
            <option value="1">1 (strongly disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (strongly agree)</option>
        </select>
        <h3>Question 6</h>
        <h4>It is often difficult for you to relate to other people’s feelings.</h4>
        <select id="Q6" name="Q6" type="text" style="width: 300px;">
            <option value="1">1 (strongly disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (strongly agree)</option>
        </select>
        <h3>Question 7</h>
        <h4>In a discussion, truth should be more important than people’s sensitivities.</h4>
        <select id="Q7" name="Q7" type="text" style="width: 300px;">
            <option value="1">1 (strongly disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (strongly agree)</option>
        </select>
        <h3>Question 8</h>
        <h4>You rarely get carried away by fantasies and ideas.</h4>
        <select id="Q8" name="Q8" type="text" style="width: 300px;">
            <option value="1">1 (strongly disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (strongly agree)</option>
        </select>
        <h3>Question 9</h>
        <h4>You think that everyone’s views should be respected regardless of whether they are supported by facts or not.</h4>
        <select id="Q9" name="Q9" type="text" style="width: 300px;">
            <option value="1">1 (strongly disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (strongly agree)</option>
        </select>
        <h3>Question 10</h>
        <h4>You think that everyone’s views should be respected regardless of whether they are supported by facts or not.</h4>
        <select id="Q10" name="Q10" type="text" style="width: 300px;">
            <option value="1">1 (strongly disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (strongly agree)</option>
        </select>
        <br>
        <br>
        <div>
            <button type="button" class="btn btn-lg btn-primary" id="submit"><h4>Submit</h4></button>
        </div>
        <footer class="footer">
    </div>
        </footer>
            <div class="container">
                <p><a href="/api/friends'>API Friends List">API Friends List</a> | <a href="https://github.com/johnnyboxhead/FriendFinder">Github Repo</a></p>
            </div>
<!-- <script type="text/javascript" src="../data/friends.js"></script>     -->
<script>
$(document).ready(function(){
    console.log("Ready!");
})

// var express = require("express");
// var bodyParser = require("body-parser");
// var path = require("path");
// var app = express();    

var friends = [];
var compatibilityDifference = [];
var difference = [];
var friendsLength;
var compatibility = 0;
var bestScore;
var bestScoreIndex;
var bestMatch;




$("#submit").on("click", function(){
    console.log("Start");
    var friend = {
        name: $("#name").val(),
        photo: $("#photo").val(),
        scores: [
            $("#Q1").val(), 
            $("#Q2").val(),
            $("#Q3").val(),
            $("#Q4").val(),
            $("#Q5").val(),
            $("#Q6").val(),
            $("#Q7").val(),
            $("#Q8").val(),
            $("#Q9").val(),
            $("#Q10").val(),
        ]
    }
    friends.push(friend)
    friendsLength = friends.length
    console.log("You have "+friendsLength+" friends")
    console.log("Friends are: ")
    console.log(friends)

    for(j=0; j<(friendsLength - 1); j++){
        console.log("testj" + j)
        for(i=0; i<10; i++){
            compatibility = parseInt(compatibility) + (parseInt(friends[friendsLength - 1].scores[i]) - parseInt(friends[j].scores[i]))
            console.log(compatibility)
        }
        if (compatibility < 0){
            compatibility = 0 - compatibility
        }
        // bestMatch = compatibilityDifference[compatibilityDifference.indexOf(bestScore)].name
        // console.log(bestMatch)
        compatibilityDifference.push(parseInt(compatibility));
        compatibility = 0
    }

    if (friends.length <= 2){
        bestMatch = friends[0].name
    }else{
    console.log("Compatibility score is: " + compatibilityDifference);
    bestScore = Math.min.apply(Math, compatibilityDifference);
    console.log("Best score is: " + bestScore);
    console.log("Index of best score: " + compatibilityDifference.indexOf(parseInt(bestScore)));
    bestScoreIndex = compatibilityDifference.indexOf(parseInt(bestScore))
    console.log("Best Score Index is: " + bestScoreIndex);
    bestMatch = friends[bestScoreIndex].name;
    bestMatchPhoto = friends[bestScoreIndex].photo;
    }
    console.log("Best match is: " + bestMatch);
    $("#myModal").style.display = "block"
    $("#myModal").on("click", function() {
        $("#myModal").style.display = "none";
    })
    window.onclick = function(event) {
        if (event.target == modal) {
            $("#myModal").style.display = "none";
        }
    }
    compatibilityDifference.length = 0;
    console.log("End");
})
</script>
</body>
</html>
